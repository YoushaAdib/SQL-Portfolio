## IDS IPS (Time Series) Dataset 


**SQL: EDA Summary**
```sql  
SELECT
    LABEL,
    COUNT(*)                        AS ATK_COUNT,
    SUM(FLOW_DURATION)              AS TOTAL_FLOW,
    ROUND(SUM(PKT_SIZE_AVG),2)      AS PKT_SIZE,
    COUNT(DISTINCT DST_PORT)        AS PORTS_HIT,
    COUNT(DISTINCT PROTOCOL)        AS PROTOCOL_COUNT,
    LISTAGG(DISTINCT PROTOCOL,', ') WITHIN GROUP (ORDER BY PROTOCOL) AS PROTOCOL, 
    ROUND((MAX(TO_DATE(TIMESTAMP, 'DD/MM/YYYY HH24:MI:SS')) - MIN (TO_DATE(TIMESTAMP, 'DD/MM/YYYY HH24:MI:SS'))) * 24 * 60* 60, 2) AS DURATION_SEC
FROM
    IDS_1
GROUP BY
    LABEL
ORDER BY
    ATK_COUNT DESC, TOTAL_FLOW DESC
```

**Analysis**


**SQL: Drilling down to Flow Duration & Attack Packets** 

```sql 
SELECT 
    LABEL,
    SUM(TOT_FWD_PKTS)       AS FWD_PKT,
    SUM(TOT_BWD_PKTS)       AS BWD_PKTS,
    ROUND(SUM(FLOW_BYT),4)           AS FLOW_BYTE,
    ROUND(SUM(FLOW_PKT),4)           AS FLOW_PKT_SUM,
    ROUND(SUM(TOT_FWD_PKTS) - SUM(TOT_BWD_PKTS),4)   AS GAP_PKT_FWD_BWD,
    ROUND(SUM(FLOW_BYT) / SUM (FLOW_PKT),4)          AS RATIO_PKT_BYTE,
    ROUND(SUM(TOT_FWD_PKTS) / COUNT(FLOW_PKT),4)     AS RATIO_COUNT_PKT
FROM 
    IDS_1
GROUP BY 
    LABEL
```


**SQL: Drilling down to Attack Flgas**

```sql 
-- DRILL DOWN INTO ATTACK FLAGS 
SELECT DISTINCT
    LABEL,
    SUM(SYN_FLAG_CNT) AS SYN,
    SUM(FIN_FLAG_CNT) AS FIN,
    SUM(RST_FLAG_CNT) AS RST,
    SUM(PSH_FLAG_CNT) AS PSH,
    SUM(ACK_FLAG_CNT) AS ACK,
    SUM(URG_FLAG_CNT) AS URG,
    SUM(SYN_FLAG_CNT + FIN_FLAG_CNT + RST_FLAG_CNT + PSH_FLAG_CNT + ACK_FLAG_CNT + URG_FLAG_CNT) AS TOTAL
FROM
    IDS_1
GROUP BY
    LABEL
ORDER BY 
    SYN DESC 
```

